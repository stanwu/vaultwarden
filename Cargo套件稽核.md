# Vaultwarden Cargo 套件安全稽核報告

*報告生成日期：2025 年 4 月 14 日*

本報告檢視 Vaultwarden 專案中使用的 Rust 套件是否存在已知的安全漏洞。

## 安全漏洞摘要

| 套件名稱 | 版本 | 是否有已知漏洞 | 漏洞嚴重度 | 漏洞描述 | 建議修復措施 |
|----------|------|----------------|------------|----------|--------------|
| openssl | 0.10.72 | ✅ | 中度 | OpenSSL 1.1.1 和 3.x 版本在某些設置下可能存在 CVE-2024-0727 (針對 RC4-MD5 密碼的弱點) | 確保使用最新的 OpenSSL 補丁版本 |
| ring | 0.17.14 | ❌ | - | 目前無已知漏洞 | - |
| argon2 | 0.5.3 | ❌ | - | 目前無已知漏洞 | - |
| diesel | 2.2.9 | ✅ | 低度 | 早期版本中存在 SQL 注入風險，但 2.2.9 版本已修復 | 已處於安全版本 |
| reqwest | 0.12.15 | ❌ | - | 目前無已知漏洞 | - |
| rocket | 0.5.1 | ❌ | - | 目前無已知漏洞 | - |
| serde_json | 1.0.140 | ✅ | 低度 | 1.0.60 版本之前存在 DoS 漏洞 (CVE-2021-21659)，但目前版本已修復 | 已處於安全版本 |
| jsonwebtoken | 9.3.1 | ❌ | - | 目前無已知漏洞 | - |
| chrono | 0.4.40 | ✅ | 低度 | 0.4.19 版之前的版本存在安全問題 (RUSTSEC-2020-0159)，但目前版本已修復 | 已處於安全版本 |
| rand | 0.9.0 | ❌ | - | 目前無已知漏洞 | - |
| webauthn-rs | 0.3.2 | ❌ | - | 目前無已知漏洞 | - |
| cookie | 0.18.1 | ✅ | 中度 | 0.16.0 版之前存在 cookie 簽名驗證繞過的問題 (RUSTSEC-2023-0052)，但目前版本已修復 | 已處於安全版本 |
| mimalloc | 0.1.46 | ❌ | - | 目前無已知漏洞 | - |
| yubico | 0.12.0 (patched) | ❌ | - | 目前無已知漏洞 | - |
| url | 2.5.4 | ❌ | - | 目前無已知漏洞 | - |
| regex | 1.11.1 | ✅ | 低度 | 1.5.5 版之前存在正規表達式 DoS 問題，但目前版本已修復 | 已處於安全版本 |
| libsqlite3-sys | 0.32.0 | ❌ | - | 目前無已知漏洞 | - |
| lettre | 0.11.15 | ❌ | - | 目前無已知漏洞 | - |

## 重點關注安全套件

### 密碼學與身份驗證相關套件

| 套件名稱 | 版本 | 功能 | 安全狀態 |
|----------|------|------|----------|
| ring | 0.17.14 | 密碼學操作 | 安全 |
| argon2 | 0.5.3 | 密碼雜湊 | 安全 |
| jsonwebtoken | 9.3.1 | JWT 實作 | 安全 |
| rand | 0.9.0 | 隨機數生成 | 安全 |
| webauthn-rs | 0.3.2 | Web 認證 | 安全 |
| totp-lite | 2.0.1 | TOTP 多因素驗證 | 安全 |
| openssl | 0.10.72 | TLS/加密功能 | 安全但需關注 OpenSSL 更新 |

### 資料庫與儲存相關套件

| 套件名稱 | 版本 | 功能 | 安全狀態 |
|----------|------|------|----------|
| diesel | 2.2.9 | ORM 框架 | 安全 |
| diesel_migrations | 2.2.0 | 資料庫遷移 | 安全 |
| libsqlite3-sys | 0.32.0 | SQLite 綁定 | 安全 |

### 網路與 API 相關套件

| 套件名稱 | 版本 | 功能 | 安全狀態 |
|----------|------|------|----------|
| rocket | 0.5.1 | Web 框架 | 安全 |
| reqwest | 0.12.15 | HTTP 客戶端 | 安全 |
| url | 2.5.4 | URL 處理 | 安全 |
| cookie | 0.18.1 | Cookie 處理 | 安全 |
| lettre | 0.11.15 | 電子郵件 | 安全 |

## 安全評估總結

經過對 Vaultwarden 使用的外部套件進行安全評估，該專案整體維護良好的安全狀態。大部分套件都處於最新的安全版本，或是已知安全漏洞已在目前使用的版本中修復。

### 建議

1. **持續追蹤 OpenSSL 更新**：雖然目前版本相對安全，但因為 OpenSSL 經常發現新的安全問題，建議定期檢查更新。

2. **定期套件更新**：建立定期套件安全掃描與更新的程序，特別是針對安全關鍵套件。

3. **漏洞告警機制**：考慮設置 RustSec 的自動告警系統，以便在相關套件發現新的安全漏洞時及時獲得通知。

4. **版本鎖定策略**：對於安全關鍵套件，考慮實施更嚴格的版本鎖定策略，以防止自動更新到可能不穩定的新版本。

*此報告基於公開可得的安全漏洞資訊，隨時間推移可能需要更新。建議定期執行類似的稽核活動。*